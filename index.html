<!DOCTYPE html>
<html lang="en">
<head>
    <title>Ai Forge</title>
    <script src="https://sdk.minepi.com/pi-sdk.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 50px;
        }
        button {
            padding: 15px 30px;
            font-size: 18px;
            background: #00f0a0;
            border: none;
            border-radius: 10px;
            cursor: pointer;
        }
    </style>
</head><!-- Pi SDK Integration -->
<script src="https://sdk.minepi.com/pi-sdk.js"></script>
<script>
// Debug logging
console.log("üöÄ PiForge SDK integration loading...");

// Initialize Pi SDK
Pi.init({ 
    version: "2.0", 
    sandbox: false
});

console.log("‚úÖ Pi SDK initialized");

// Make Connect Wallet button work
function connectPiWallet() {
    console.log("üîó Connect button clicked");
    Pi.authenticate(['payments', 'username']).then(function(auth) {
        console.log("‚úÖ Wallet connected:", auth);
        document.body.innerHTML += `
            <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border: 3px solid green; border-radius: 10px; z-index: 10000;">
                <h2>‚úÖ Wallet Connected!</h2>
                <p>Now let's complete the deployment...</p>
                <button onclick="testDeploymentPayment()" style="padding: 15px; background: #00f0a0; color: black; border: none; border-radius: 10px; font-size: 18px; margin: 10px;">
                    üöÄ COMPLETE DEPLOYMENT
                </button>
            </div>
        `;
    }).catch(function(error) {
        console.error("‚ùå Wallet connection failed:", error);
        alert("Error: " + error.message + "\n\nMake sure you're in Pi Browser!");
    });
}

// Test payment function
function testDeploymentPayment() {
    console.log("üí≥ Starting test payment...");
    Pi.createPayment({
        amount: 0.01,
        memo: "PiForge Deployment Test",
        metadata: { test: true }
    }, {
        onReadyForServerApproval: function(paymentId) {
            console.log("‚úÖ Payment ready:", paymentId);
            alert("Payment initiated! Check your Pi Wallet to approve...");
        },
        onReadyForServerCompletion: function(paymentId, txid) {
            console.log("üéâ Payment completed:", paymentId, txid);
            alert("‚úÖ DEPLOYMENT COMPLETE! Your app is now live!");
        },
        onCancel: function(paymentId) {
            console.log("‚ùå Payment cancelled:", paymentId);
            alert("Payment cancelled. Please try again.");
        },
        onError: function(error) {
            console.error("‚ùå Payment error:", error);
            alert("Payment error: " + error.message);
        }
    });
}

// Wire up the button when page loads
document.addEventListener('DOMContentLoaded', function() {
    console.log("üìÑ Page loaded, looking for Connect button...");
    
    // Try to find and wire up the Connect button
    const connectBtn = document.querySelector('button');
    if (connectBtn) {
        console.log("üîò Found button:", connectBtn.textContent);
        connectBtn.onclick = connectPiWallet;
        connectBtn.style.border = "3px solid red"; // Visual indicator
    } else {
        console.log("‚ùå No button found");
        // Create a fallback button
        document.body.innerHTML += `
            <button onclick="connectPiWallet()" style="position: fixed; top: 20px; right: 20px; padding: 15px; background: red; color: white; border: none; border-radius: 10px; z-index: 9999;">
                üîó CONNECT PI WALLET
            </button>
        `;
    }
});

console.log("üéØ PiForge integration ready!");
</script>
<body>
    <h1>Ai Forge</h1>
    <p>Build Ethical AI Apps on Pi Network</p>
    
    <button onclick="connectPiWallet()">Connect Pi Wallet</button>
    
    <div id="status"></div>

    <script>
        Pi.init({ 
            version: "2.0", 
            sandbox: false
        });

        function connectPiWallet() {
            Pi.authenticate(['payments', 'username'], function(auth) {
                document.getElementById('status').innerHTML = `
                    <div style="color: green; margin: 20px;">
                        ‚úÖ Wallet Connected! Ready to test deployment transaction.
                    </div>
                    <button onclick="testDeploymentPayment()" style="padding: 15px; background: #00f0a0; color: black; border: none; border-radius: 10px; font-size: 18px;">
                        üöÄ COMPLETE DEPLOYMENT (Test Payment)
                    </button>
                `;
            }).catch(function(error) {
                console.error("Wallet connection failed:", error);
                alert("Wallet connection failed. Please make sure you're in Pi Browser.");
            });
        }

        function testDeploymentPayment() {
            Pi.createPayment({
                amount: 0.01,
                memo: "PiForge Deployment Verification",
                metadata: { 
                    test: true,
                    deployment: "final_step"
                }
            }, {
                onReadyForServerApproval: function(paymentId) {
                    console.log("Payment ready for approval:", paymentId);
                    document.getElementById('status').innerHTML += `
                        <div style="color: orange; margin: 10px;">
                            ‚ö° Payment initiated! Check your Pi Wallet to approve...
                        </div>
                    `;
                },
                onReadyForServerCompletion: function(paymentId, txid) {
                    console.log("Payment completed!", paymentId, txid);
                    document.getElementById('status').innerHTML += `
                        <div style="color: green; margin: 10px; font-weight: bold;">
                            ‚úÖ DEPLOYMENT COMPLETE! Your app is now live!
                        </div>
                    `;
                },
                onCancel: function(paymentId) {
                    console.log("Payment cancelled:", paymentId);
                    alert("Payment cancelled. Please try again to complete deployment.");
                },
                onError: function(error, payment) {
                    console.error("Payment error:", error);
                    alert("Payment error: " + error.message);
                }
            });
        }
    </script>
</body>
</html>
